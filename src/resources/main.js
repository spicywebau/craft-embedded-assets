(()=>{"use strict";var e={641:(e,t,n)=>{n.d(t,{Z:()=>a});var r=n(81),o=n.n(r),i=n(645),s=n.n(i)()(o());s.push([e.id,'#header .embedded-assets_button{position:relative;overflow:hidden;margin-right:7px}.embedded-assets_form_field{position:relative;z-index:1;display:flex;padding:0 24px;box-shadow:0 1px rgba(0,0,20,.1)}.embedded-assets_form_field>label,.embedded-assets_form_field>input{padding:22px 0;font-size:14px;line-height:20px}.embedded-assets_form_field>label{order:1;padding-right:14px;font-weight:normal;color:#8f98a3;cursor:text;user-select:none}.embedded-assets_form_field>input{order:2;flex:1;box-sizing:border-box;display:block;border-radius:0;border:0;background:rgba(0,0,0,0);color:#29323d;appearance:none;outline:0}.embedded-assets_form_body{position:relative;overflow:hidden;transition:height .3s}.embedded-assets_form_body>.embedded-assets_preview,.embedded-assets_form_body>.spinner{opacity:0;transition:opacity .3s}.embedded-assets_form_body>.embedded-assets_preview{position:absolute;top:0;bottom:0;left:0;right:0}.embedded-assets_form_body>.spinner{pointer-events:none;position:absolute;top:47.5px;left:50%;transform:translate(-50%, -50%)}.embedded-assets_form[data-state=idle] .embedded-assets_form_body{height:0 !important}.embedded-assets_form[data-state=requesting] .embedded-assets_form_body{height:95px !important}.embedded-assets_form[data-state=requesting] .embedded-assets_form_body>.spinner{opacity:1}.embedded-assets_form[data-state=requested] .embedded-assets_form_body,.embedded-assets_form[data-state=saving] .embedded-assets_form_body{height:300px}.embedded-assets_form[data-state=requested] .embedded-assets_form_body>.embedded-assets_preview,.embedded-assets_form[data-state=saving] .embedded-assets_form_body>.embedded-assets_preview{opacity:1}.embedded-assets_preview{position:relative}.embedded-assets_preview>iframe{position:absolute;top:0;left:0;width:100% !important;height:100% !important}.elementeditor .embedded-assets_preview{margin-top:-8px;margin-bottom:8px;background-color:#f2f5f8}.elementeditor .embedded-assets_preview::after{content:"";display:block;position:absolute;bottom:0;left:0;right:0;height:1px;background-color:rgba(0,0,20,.1)}.embedded-assets_hud_main{transition:padding-bottom .3s}.embedded-assets_hud_footer{position:absolute !important;left:0;right:0;bottom:0;transform:translateY(100%);transition:transform .3s}.embedded-assets_hud.show-footer .embedded-assets_hud_main{padding-bottom:46px}.embedded-assets_hud.show-footer .embedded-assets_hud_footer{opacity:1;transform:none}.embedded-assets_label{display:block;line-height:16px;white-space:nowrap}.embedded-assets_label>img{display:inline-block;width:16px;height:16px;margin-right:10px;vertical-align:middle;object-fit:contain}.elementeditor .image-preview>img{max-width:380px;max-height:190px}',""]);const a=s},645:e=>{e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var n="",r=void 0!==t[5];return t[4]&&(n+="@supports (".concat(t[4],") {")),t[2]&&(n+="@media ".concat(t[2]," {")),r&&(n+="@layer".concat(t[5].length>0?" ".concat(t[5]):""," {")),n+=e(t),r&&(n+="}"),t[2]&&(n+="}"),t[4]&&(n+="}"),n})).join("")},t.i=function(e,n,r,o,i){"string"==typeof e&&(e=[[null,e,void 0]]);var s={};if(r)for(var a=0;a<this.length;a++){var u=this[a][0];null!=u&&(s[u]=!0)}for(var c=0;c<e.length;c++){var d=[].concat(e[c]);r&&s[d[0]]||(void 0!==i&&(void 0===d[5]||(d[1]="@layer".concat(d[5].length>0?" ".concat(d[5]):""," {").concat(d[1],"}")),d[5]=i),n&&(d[2]?(d[1]="@media ".concat(d[2]," {").concat(d[1],"}"),d[2]=n):d[2]=n),o&&(d[4]?(d[1]="@supports (".concat(d[4],") {").concat(d[1],"}"),d[4]=o):d[4]="".concat(o)),t.push(d))}},t}},81:e=>{e.exports=function(e){return e[1]}},379:e=>{var t=[];function n(e){for(var n=-1,r=0;r<t.length;r++)if(t[r].identifier===e){n=r;break}return n}function r(e,r){for(var i={},s=[],a=0;a<e.length;a++){var u=e[a],c=r.base?u[0]+r.base:u[0],d=i[c]||0,l="".concat(c," ").concat(d);i[c]=d+1;var f=n(l),h={css:u[1],media:u[2],sourceMap:u[3],supports:u[4],layer:u[5]};if(-1!==f)t[f].references++,t[f].updater(h);else{var p=o(h,r);r.byIndex=a,t.splice(a,0,{identifier:l,updater:p,references:1})}s.push(l)}return s}function o(e,t){var n=t.domAPI(t);n.update(e);return function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap&&t.supports===e.supports&&t.layer===e.layer)return;n.update(e=t)}else n.remove()}}e.exports=function(e,o){var i=r(e=e||[],o=o||{});return function(e){e=e||[];for(var s=0;s<i.length;s++){var a=n(i[s]);t[a].references--}for(var u=r(e,o),c=0;c<i.length;c++){var d=n(i[c]);0===t[d].references&&(t[d].updater(),t.splice(d,1))}i=u}}},569:e=>{var t={};e.exports=function(e,n){var r=function(e){if(void 0===t[e]){var n=document.querySelector(e);if(window.HTMLIFrameElement&&n instanceof window.HTMLIFrameElement)try{n=n.contentDocument.head}catch(e){n=null}t[e]=n}return t[e]}(e);if(!r)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");r.appendChild(n)}},216:e=>{e.exports=function(e){var t=document.createElement("style");return e.setAttributes(t,e.attributes),e.insert(t,e.options),t}},565:(e,t,n)=>{e.exports=function(e){var t=n.nc;t&&e.setAttribute("nonce",t)}},795:e=>{e.exports=function(e){var t=e.insertStyleElement(e);return{update:function(n){!function(e,t,n){var r="";n.supports&&(r+="@supports (".concat(n.supports,") {")),n.media&&(r+="@media ".concat(n.media," {"));var o=void 0!==n.layer;o&&(r+="@layer".concat(n.layer.length>0?" ".concat(n.layer):""," {")),r+=n.css,o&&(r+="}"),n.media&&(r+="}"),n.supports&&(r+="}");var i=n.sourceMap;i&&"undefined"!=typeof btoa&&(r+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(i))))," */")),t.styleTagTransform(r,e,t.options)}(t,e,n)},remove:function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(t)}}}},589:e=>{e.exports=function(e,t){if(t.styleSheet)t.styleSheet.cssText=e;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(e))}}}},t={};function n(r){var o=t[r];if(void 0!==o)return o.exports;var i=t[r]={id:r,exports:{}};return e[r](i,i.exports,n),i.exports}n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.nc=void 0,(()=>{var e=n(379),t=n.n(e),r=n(795),o=n.n(r),i=n(569),s=n.n(i),a=n(565),u=n.n(a),c=n(216),d=n.n(c),l=n(589),f=n.n(l),h=n(641),p={};p.styleTagTransform=f(),p.setAttributes=u(),p.insert=s().bind(null,"head"),p.domAPI=o(),p.insertStyleElement=d();t()(h.Z,p);h.Z&&h.Z.locals&&h.Z.locals;const b=jQuery;var m=n.n(b);const v=Craft;var g=n.n(v);function y(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var _=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._events=new Map}var t,n,r;return t=e,n=[{key:"on",value:function(e,t){this._events.has(e)||this._events.set(e,[]),this._events.get(e).push(t)}},{key:"off",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(this._events)if(t&&this._events.has(e)){var n=this._events.get(e).filter((function(e){return e!==t}));n.length>0?this._events.set(e,n):this._events.delete(e)}else this._events.delete(e)}},{key:"trigger",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this._events&&this._events.has(e)&&(n=Object.assign(n,{type:e}),this._events.get(e).forEach((function(e){return e.call(t,n)})))}}],n&&y(t.prototype,n),r&&y(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();const w=Garnish;var O=n.n(w);var $=0;function j(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"uid";return e+Math.random().toString(36).substr(2)+$++}function k(e){return/^https?:\/\//.test(e)}function P(e){return P="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},P(e)}function x(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function S(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?x(Object(n),!0).forEach((function(t){T(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):x(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function T(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function E(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function A(e,t){return A=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},A(e,t)}function q(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=C(e);if(t){var o=C(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return R(this,n)}}function R(e,t){if(t&&("object"===P(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function C(e){return C=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},C(e)}var D=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&A(e,t)}(i,e);var t,n,r,o=q(i);function i(){var e;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),e=o.call(this);var t=j();return e.$element=m()('\n      <div class="embedded-assets_preview">\n        <iframe id="'.concat(t,'" src="about:blank"></iframe>\n      </div>\n    ')),e.$iframe=e.$element.find("#".concat(t)),e._setupHeightMonitor(),e}return t=i,n=[{key:"destroy",value:function(){this.$element.remove(),this.$element=null,this._$warningTrigger&&(this._$warningTrigger.remove(),this._$warningTrigger=null),this._warningHud&&(this._warningHud.hide(),this._warningHud.$hud.remove(),this._warningHud.$shade.remove(),this._warningHud=null),window.cancelAnimationFrame(this._heightMonitor),clearTimeout(this._requestTimeout),this.trigger("destroy")}},{key:"getWindow",value:function(){return this.$iframe[0].contentWindow}},{key:"getDocument",value:function(){var e=this.getWindow();return e?e.document:null}},{key:"getBody",value:function(){var e=this.getDocument();return e?e.body:null}},{key:"showWarning",value:function(){var e=this,t=m()(this.getWindow()),n=m()(this.getDocument()).find("#warning");if(n.length>0){var r=this.$iframe.offset(),o=r.top,i=r.left,s=t.scrollTop(),a=n.offset(),u=o-s+a.top,c=i+a.left,d=n.outerWidth(),l=n.outerHeight();if(this._$warningTrigger||(this._$warningTrigger=m()("<div>").css({position:"absolute",display:"none"}),O().$bod.append(this._$warningTrigger)),this._$warningTrigger.css({display:"block",top:u+"px",left:c+"px",width:d+"px",height:l+"px"}),this._warningHud)this._warningHud.show();else{var f=g().t("embeddedassets","This information is coming from an untrusted source."),h=g().t("embeddedassets","As a security measure embed codes will not be shown."),p=m()("\n          <p><strong>".concat(f,"</strong></p>\n          <p>").concat(h,"</p>\n        "));this._warningHud=new(O().HUD)(this._$warningTrigger,p,{hudClass:"hud info-hud",closeOtherHUDs:!1,onHide:function(){return e._$warningTrigger.css("display","none")}})}}}},{key:"request",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:15e3;t=Object.assign({url:null,assetId:null,showContent:!0,callback:j("embeddedassets")},t);var r=this.getWindow();if(r){clearTimeout(this._requestTimeout);var o=Boolean(t.url||t.assetId),i="about:blank";if(o){var s=function(n){clearTimeout(e._requestTimeout),delete window[t.callback],e.trigger(n,a)};window[t.callback]=function(){e._setupWarning(),s("load")},this._requestTimeout=setTimeout((function(){return s("timeout")}),n);var a={showContent:t.showContent?1:0,callback:t.callback};t.url?a.url=t.url:t.assetId&&(a.assetId=t.assetId),i=g().getActionUrl("embeddedassets/actions/preview",S(S({},a),{},{url:void 0!==a.url?a.url:null}))}r.location.replace(i)}}},{key:"_setupHeightMonitor",value:function(){var e=this;this._height=0,function t(){var n=m()(e.getBody()).height()||0;e._height!==n&&(e.trigger("resize",{prevHeight:e._height,height:n}),e._height=n),e._heightMonitor=window.requestAnimationFrame(t)}()}},{key:"_setupWarning",value:function(){var e=this,t=m()(this.getDocument()).find("#warning");t.length>0&&(t.off(".embeddedassets"),t.on("click.embeddedassets",(function(){return e.showWarning()})))}}],n&&E(t.prototype,n),r&&E(t,r),Object.defineProperty(t,"prototype",{writable:!1}),i}(_);function B(e){return B="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},B(e)}function I(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function H(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?I(Object(n),!0).forEach((function(t){M(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):I(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function M(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function F(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function W(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function U(e,t){return U=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},U(e,t)}function z(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Z(e);if(t){var o=Z(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return L(this,n)}}function L(e,t){if(t&&("object"===B(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function Z(e){return Z=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Z(e)}var G=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&U(e,t)}(i,e);var t,n,r,o=z(i);function i(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:function(){};F(this,i),(e=o.call(this))._getActionTarget=t;var n=j(),r=j(),s=g().getActionUrl("embeddedassets/actions/save");return e.$element=m()('\n      <form class="embedded-assets_form" action="'.concat(s,'" method="post">\n        <div class="embedded-assets_form_field">\n          <label for="').concat(n,'">URL</label>\n          <input type="text" placeholder="http://" id="').concat(n,'" name="url" autocomplete="off" spellcheck="false">\n        </div>\n        <div id="').concat(r,'" class="embedded-assets_form_body">\n          <div class="spinner"></div>\n        </div>\n      </form>\n    ')),e.$input=e.$element.find("#".concat(n)),e.$body=e.$element.find("#".concat(r)),e.preview=new D,e.$body.prepend(e.preview.$element),e.preview.on("load",(function(t){t.url===e._url&&"requesting"===e._state&&e.setState("requested")})),e.preview.on("timeout",(function(t){t.url===e._url&&"requesting"===e._state&&(g().cp.displayError(g().t("embeddedassets","Could not retrieve embed information.")),e.setState("idle"))})),e.preview.on("resize",(function(t){return e.$body.css("height",t.height+"px")})),e.$element.on("submit",(function(t){t.preventDefault();var n=e._url===e.$input.val();"idle"===e._state||"saving"!==e._state&&!n?e.request():"requested"===e._state&&n&&e.save()})),e.$input.on("change blur",(function(){return e.request()})),e.$input.on("paste",(function(t){var n=(t.clipboardData||t.originalEvent.clipboardData||window.clipboardData).getData("text");e.request(n)})),e._setupHeightMonitor(),e.setState("idle"),e}return t=i,n=[{key:"destroy",value:function(){this.preview.destroy(),this.$element.remove(),this.$element=null,this.$input=null,this.$body=null,window.cancelAnimationFrame(this._heightMonitor),this.trigger("destroy")}},{key:"request",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.$input.val();"saving"!==this._state&&this._url!==e&&(this._url=e,k(e)?(this.setState("requesting"),this.preview.request({url:e})):this.setState("idle"))}},{key:"focus",value:function(){this.$input[0].select(),this.$input[0].focus()}},{key:"clear",value:function(){this.$input.val(""),this.trigger("clear"),this.setState("idle")}},{key:"setReplace",value:function(e,t){this._replace=e,this._replaceAssetId=t}},{key:"save",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.$input.val(),n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this._getActionTarget(),r=H(H({},n),{},{url:t,assetId:this._replaceAssetId});g().queue.push((function(){return new Promise((function(t,n){g().sendActionRequest("POST","embeddedassets/actions/".concat(e._replace?"replace":"save"),{data:r}).then((function(r){"saving"===e._state&&r.data.success?(e.clear(),e.trigger("save",r.data.payload),t()):(r.data&&r.data.error&&g().cp.displayError(r.data.error),e.setState("requested"),n(new Error(r.data.error)))})).catch(n)}))})),this.setState("saving")}},{key:"setState",value:function(e){switch(this._state=e,this.$element.attr("data-state",e),e){case"idle":this._url="",this.trigger("idle");break;case"requesting":this.trigger("requesting");break;case"requested":this.trigger("requested");break;case"saving":this.trigger("saving")}}},{key:"_setupHeightMonitor",value:function(){var e=this;this._height=0,function t(){var n=e.$element.height();e._height!==n&&(e.trigger("resize",{prevHeight:e._height,height:n}),e._height=n),e._heightMonitor=window.requestAnimationFrame(t)}()}}],n&&W(t.prototype,n),r&&W(t,r),Object.defineProperty(t,"prototype",{writable:!1}),i}(_);function N(e){return N="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},N(e)}function J(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function K(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Q(e,t){return Q=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Q(e,t)}function Y(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=X(e);if(t){var o=X(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return V(this,n)}}function V(e,t){if(t&&("object"===N(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function X(e){return X=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},X(e)}var ee=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Q(e,t)}(i,e);var t,n,r,o=Y(i);function i(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:function(){};return J(this,i),(e=o.call(this))._getActionTarget=t,e.form=null,e.hud=null,e}return t=i,n=[{key:"create",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};n=Object.assign({hudClass:"hud embedded-assets_hud",mainClass:"embedded-assets_hud_main",minBodyWidth:400},n);var r=j(),o=j(),i=j(),s=g().t("app","Cancel"),a=g().t("app","Save");this.$footer=m()('\n      <div class="hud-footer embedded-assets_hud_footer">\n        <div class="buttons right">\n          <div id="'.concat(r,'" class="btn">').concat(s,'</div>\n          <div id="').concat(o,'" class="btn submit">').concat(a,'</div>\n          <div id="').concat(i,'" class="spinner hidden"></div>\n        </div>\n      </div>\n    ')),this.$cancel=this.$footer.find("#".concat(r)),this.$save=this.$footer.find("#".concat(o)),this.$spinner=this.$footer.find("#".concat(i)),this.form=new G(this._getActionTarget),this.hud=new(O().HUD)(e,this.form.$element.add(this.$footer),n),this.trigger("create"),this.$save.on("click",(function(e){return t.$save.hasClass("disabled")&&e.stopImmediatePropagation()})),this.$cancel.on("click",(function(){return t.form.clear()})),this.$save.on("click",(function(){return t.form.save()})),this.form.on("submit",(function(){return t.form.save()})),this.form.on("save",(function(e){return t.trigger("save",e)})),this.hud.on("show",(function(){return t.trigger("show")})),this.hud.on("hide",(function(){return t.trigger("hide")})),this.form.on("clear",(function(){return t.hide()})),this.form.on("save",(function(){return t.hide()})),this.hud.on("show",(function(){return t.form.request()})),this.hud.on("show",(function(){return t.form.focus()})),this.hud.on("hide",(function(){return t.form.setState("idle")})),this.hideFooter(),this.form.on("idle",(function(){return t.hideFooter()})),this.form.on("requesting",(function(){return t.hideFooter()})),this.form.on("requested",(function(){return t.showFooter()})),this.form.on("idle",(function(){return t.setSaving(!1)})),this.form.on("requesting",(function(){return t.setSaving(!1)})),this.form.on("requested",(function(){return t.setSaving(!1)})),this.form.on("saving",(function(){return t.setSaving()})),this.form.on("resize",(function(){return t.hud.updateSizeAndPosition()}))}},{key:"destroy",value:function(){this.$footer&&(this.$footer.remove(),this.$footer=null),this.form&&(this.form.destroy(),this.form=null),this.hud&&(this.hud.hide(),this.hud.$hud.remove(),this.hud.$shade.remove(),this.hud=null),window.cancelAnimationFrame(this._monitor),this.trigger("destroy")}},{key:"show",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.hud?(this.hud.setSettings(t),this.hud.$trigger=m()(e),this.hud.showing?this.hud.queueUpdateSizeAndPosition():this.hud.show()):(this.create(e,t),this.form.focus()),this.trigger("show")}},{key:"hide",value:function(){this.hud&&this.hud.hide(),this.trigger("hide")}},{key:"hideFooter",value:function(){this.hud&&this.hud.$hud.removeClass("show-footer")}},{key:"showFooter",value:function(){this.hud&&this.hud.$hud.addClass("show-footer")}},{key:"setSaving",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.$save.toggleClass("disabled",e),this.$spinner.toggleClass("hidden",!e)}}],n&&K(t.prototype,n),r&&K(t,r),Object.defineProperty(t,"prototype",{writable:!1}),i}(_);function te(e){return te="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},te(e)}function ne(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function re(e,t){return re=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},re(e,t)}function oe(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=se(e);if(t){var o=se(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return ie(this,n)}}function ie(e,t){if(t&&("object"===te(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function se(e){return se=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},se(e)}var ae=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&re(e,t)}(i,e);var t,n,r,o=oe(i);function i(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(e=o.call(this))._currentGetActionTarget=function(){return-1},e.modal=new ee((function(){return e._getActionTarget()})),e.buttons=[],e.modal.on("hide",(function(){return e.buttons.forEach((function(e){return e.setActive(!1)}))})),e.modal.on("save",(function(t){return e.trigger("save",t)})),e}return t=i,n=[{key:"destroy",value:function(){this.modal.destroy(),this.modal=null,this.trigger("destroy")}},{key:"setReplaceAssetId",value:function(e){this._replaceAssetId=e}},{key:"addButton",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:["bottom","top","left","right"],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){},o=arguments.length>3&&void 0!==arguments[3]&&arguments[3];this.buttons.push(e),e.$element.on("click",(function(){t.modal&&(t._currentGetActionTarget=r,t.buttons.forEach((function(t){return t.setActive(t===e)})),t.modal.show(e.$element,{orientations:n},o),t.modal.form.setReplace(o,t._replaceAssetId))})),this.trigger("addButton",{button:e})}},{key:"removeButton",value:function(e){this.buttons=this.buttons.filter((function(t){return t!==e})),this.trigger("removeButton",{button:e})}},{key:"_getActionTarget",value:function(){return this._currentGetActionTarget()}}],n&&ne(t.prototype,n),r&&ne(t,r),Object.defineProperty(t,"prototype",{writable:!1}),i}(_);function ue(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var ce,de,le,fe,he=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.$element=m()('<div class="embedded-assets_button btn" data-icon="globe"></div>'),this.setLabel(t)}var t,n,r;return t=e,n=[{key:"destroy",value:function(){this.$element.remove(),this.$element=null}},{key:"setLabel",value:function(e){this.$element.text(g().t("embeddedassets",e))}},{key:"show",value:function(){this.$element.show()}},{key:"hide",value:function(){this.$element.hide()}},{key:"setActive",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.$element.toggleClass("active",e)}}],n&&ue(t.prototype,n),r&&ue(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}(),pe=new ae;ce=g().AssetIndex,de="init",le=function(){var e,t=this,n=new he("Embed"),r=new he("Replace"),o=this.$uploadButton,i=o.closest("#header").length>0,s=o.closest(".modal").length>0,a=this.settings.criteria?this.settings.criteria.kind:[];i?(this.$uploadButton.before(n.$element),this.$uploadButton.before(r.$element),e=["bottom","left","right","top"]):s&&(this.$uploadButton.after(n.$element),this.$uploadButton.after(r.$element),e=["top","right","bottom","left"]);var u=function(e,t){"string"==typeof t&&(t=[t]),t&&t.length>0&&-1===t.indexOf("json")?e.hide():e.show()};u(n,a),r.hide();var c=function(){var e=t.sourceKey.split(":");return e[e.length-2]?{targetType:e[e.length-2],targetUid:e[e.length-1]}:{}};pe.addButton(n,e,c),pe.addButton(r,e,c,!0);var d=[];pe.on("save",(function(e){d.push(e.assetId),t.updateElements()})),this.on("updateElements",(function(){d.forEach((function(e){return t.view.selectElementById(e)})),d=[],u(n,a),r.hide()})),this.on("selectionChange",(function(e){var t=e.target.view.elementSelect.$selectedItems;t.length&&1===t.length&&m()(t[0]).find("[data-embedded-asset]").length?(n.hide(),r.show(),pe.setReplaceAssetId(t[0].attributes["data-id"].value)):(u(n,a),r.hide())}))},fe=ce.prototype[de],ce.prototype[de]=function(){fe.apply(this,arguments),le.call(this)},window.EmbeddedAssets=pe})()})();